name: Generate Wallpapers README

on:
  workflow_dispatch: # manual trigger
  schedule:
    - cron: '0 0 * * 0' # optional: weekly

jobs:
  generate-readme:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v5

      - name: Set up Git
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"

      - name: Generate README
        run: |
          echo "# ðŸ–¼ Wallpapers" > README.md
          echo "" >> README.md
          echo "A collection of **high-quality 4K aesthetic wallpapers**. Perfect for desktops, backgrounds, and inspiration!" >> README.md
          echo "" >> README.md
          TOTAL=$(ls *.png *.jpg *.jpeg *.webp 2>/dev/null | wc -l)
          echo "![Total Wallpapers](https://img.shields.io/badge/Total-$TOTAL-blue)" >> README.md
          echo "" >> README.md
          echo "## Install" >> README.md
          echo "" >> README.md
          echo "You can easily get all the wallpapers:" >> README.md
          echo '```bash' >> README.md
          echo 'git clone https://github.com/phucisstupid/wallpapers' >> README.md
          echo '```' >> README.md
          echo "" >> README.md
          echo "## Gallery" >> README.md
          echo "ðŸ’¡ Tip: Click on any image to view full-size. Enjoy your stolen wallpapers!" >> README.md

          echo "<table>" >> README.md
          count=0
          echo "<tr>" >> README.md
          for img in *.png *.jpg *.jpeg *.webp; do
            [ -f "$img" ] || continue
            echo "<td><a href=\"$img\"><img src=\"$img\" width=\"200\" /></a></td>" >> README.md
            count=$((count+1))
            if [ $count -eq 4 ]; then
              echo "</tr><tr>" >> README.md
              count=0
            fi
          done
          echo "</tr>" >> README.md
          echo "</table>" >> README.md

      - name: Commit and push
        run: |
          git add .
          git commit -m "Update README" || echo "No changes to commit"
          git push
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
